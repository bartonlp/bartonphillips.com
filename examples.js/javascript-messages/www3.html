<!DOCTYPE html>
<html>
<body>

<p>Click the button to open a new window with some specifications.</p>

<button onclick="myFunction()">Try it</button>
<p id="response">Response goes here</p>
<button onclick="sendMessage()">Send</button>

<script>
let newWindow;

function myFunction() {
  newWindow = window.open("https://bartonphillips.com/examples.js/javascript-messages/popup.php", "_blank", "top=500,left=1500,width=400,height=400");
}

const response = document.getElementById('response');

window.addEventListener('message', (event) => {
    if(event.data?.msg) {
        response.innerText = event.data.msg;
    }
})

function sendMessage() {
	newWindow.postMessage(JSON.stringify(["This is a message"]), '*');
}
</script>

</body>
</html>
